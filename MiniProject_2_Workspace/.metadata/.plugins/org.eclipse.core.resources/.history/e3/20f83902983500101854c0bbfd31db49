<!doctype html>
<html lang="en">

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Registration Page</title>
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.5/dist/css/bootstrap.min.css" rel="stylesheet"
		integrity="sha384-SgOJa3DmI69IUzQ2PVdRZhwQ+dy64/BUtbMJw1MZ8t5HZApcHrRKUc4W0kG879m7" crossorigin="anonymous">

	<script src="/webjars/jquery/3.6.4/jquery.min.js"></script>

	<script>
		$(document).ready(function () {
			$('#countryId').on('change', function () {
				var selectedCountryId = $(this).val();
				$.ajax({
					url: '/states',
					type: 'GET',
					data: {countryId: selectedCountryId},
					success: function (response) {

						$('#stateId').empty();

						$('#stateId').append('<option value="">Select State </option>')

						$.each(response, function (key, value) {
							$('<option>').val(key).text(value).appendTo("#stateId");
						});
					},
					error: function (xhr, status, error) {
						console.error('AJAX Error:', error);
					}
				});
			});

			$(document).ready(function () {
				$('#stateId').on('change', function () {
					var selectedStateId = $(this).val();
					$.ajax({
						url: '/cities',
						type: 'GET',
						data: {cityId: selectedCityId},
						success: function (response) {

							$('#cityId').empty();

							$('#cityId').append('<option value="">Select city </option>')

							$.each(response, function (key, value) {
								$('<option>').val(key).text(value).appendTo("#cityId");
							});
						},
						error: function (xhr, status, error) {
							console.error('AJAX Error:', error);
						}
					});
				});
			});
	</script>
</head>

<body>

	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.5/dist/js/bootstrap.bundle.min.js"
		integrity="sha384-k6d4wzSIapyDyv1kpU366/PK5hCdSbCRGRCMv+eplOQJWyd1fbcAu9OCUj5zNLiq"
		crossorigin="anonymous"></script>

	<div class="container">

		<h2>Register Here</h2>

		<form action="@{/register}" th:object="${User}" method="post">

			<font style="color: red;">

				<p th:field="${emsg}"></p>

			</font>

			<font style="color: green;">

				<p th:field="${smsg}"></p>

			</font>

			<table>
				<tr>
					<td>Name: </td>
					<td> <input type="text" th:field="*{name}" /> </td>
				</tr>

				<tr>
					<td>Email:</td>
					<td><input type="email" th:field="*{email}" /> </td>
				</tr>

				<tr>
					<td>Phno:</td>
					<td><input type="number" th:field="*{phoneNumber}" /> </td>
				</tr>

				<tr>
					<td>Country:</td>
					<td>
						<select th:field="*{countryId}">

							<option value="">-Select-</option>
							<option th:each="entry : ${Countries.entrySet()}" th:value="${entry.key}"
								th:text="${entry.value}">

							</option>

						</select>
					</td>
				</tr>

				<tr>
					<td>State:</td>
					<td>
						<select th:field="*{stateId}">
							<option value="">-Select-</option>
						</select>
					</td>
				</tr>

				<tr>
					<td>City:</td>
					<td>
						<select th:field="*{cityId}">
							<option value="">-Select-</option>
						</select>
					</td>
				</tr>

			</table>

			<input type="submit" value="Sign-Up" />
		</form>
	</div>
</body>

</html>